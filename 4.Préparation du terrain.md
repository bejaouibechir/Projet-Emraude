# Préparation d'un Atelier de Microservices sous Windows 11

## Installation de WSL

```sh
# Installation de WSL
wsl --install
```

# Lancement de WSL
```sh
wsl
```

# Liste des distributions disponibles
```sh
wsl.exe --list --online
```
# Installation d'Ubuntu
```sh
wsl.exe --install Ubuntu
```

## Installation de kubectl

Suivez la procédure d'installation de kubectl sur Windows en utilisant le lien suivant :
[Installation de kubectl](https://kubernetes.io/fr/docs/tasks/tools/install-kubectl/#install-kubectl-on-windows)

## Installation de Minikube

Suivez la procédure d'installation de Minikube sur Windows en utilisant le lien suivant :
[Installation de Minikube](https://minikube.sigs.k8s.io/docs/start/?arch=%2Fwindows%2Fx86-64%2Fstable%2F.exe+download)

## Activation de Dashboard et Ingress dans Minikube

```sh
# Démarrage de Minikube
minikube start

# Vérification de l'état de Minikube
minikube

# Liste des pods
kubectl get po

# Liste des namespaces
kubectl get ns

# Liste des addons disponibles
minikube addons

# Activation des addons
minikube addons enable dashboard
minikube addons enable ingress

# Vérification des addons activés
minikube addons list
```

## Remarques et Suggestions

### Vérification des Pré-requis

- Assurez-vous que votre système d'exploitation est à jour.
- Vérifiez que la virtualisation est activée dans le BIOS de votre machine.

### Installation de WSL
Pour installer WSL il faut suivre ce lien [Installation de WSL](https://learn.microsoft.com/fr-fr/windows/wsl/install)

### kubectl

- Après l'installation de kubectl, ajoutez le répertoire où il est installé à votre PATH si ce n'est pas déjà fait.
- Vérifiez la version de kubectl installée avec :
  ```sh
  kubectl version --client
  ```

### Minikube

- Assurez-vous d'utiliser le dernier stable de minikube. Vérifiez avec :
  ```sh
  minikube update-check
  ```
- Spécifiez un driver pour minikube pour une meilleure performance, par exemple, hyperv :
  ```sh
  minikube start --driver=hyperv
  ```

### Dashboard et Ingress

- Pour accéder au dashboard, utilisez la commande suivante après l'avoir activé :
  ```sh
  minikube dashboard
  ```
- Pour vérifier que l'ingress fonctionne correctement, créez une simple règle d'ingress et testez-la avec un service.

### Compléter l'Environnement

- **Helm** : Installer Helm pour la gestion des charts Kubernetes :
  ```sh
  curl https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 | bash
  ```
- **Docker** : Assurez-vous que Docker est installé et fonctionne correctement avec WSL2.
- **VS Code** : Utilisez Visual Studio Code avec les extensions appropriées (Remote - WSL, Kubernetes, Docker, etc.)

### Sécurité

- Pour des environnements de production ou de tests sensibles, configurez les accès et les politiques de sécurité (RBAC) dans Kubernetes.

### Ressources et Performance

- Ajustez les ressources allouées à minikube selon vos besoins (CPU, RAM, etc.).

## Exemple de Fichier YAML pour Ingress

Voici un exemple de configuration YAML pour un Ingress simple :

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: example-ingress
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
  - host: yourapp.local
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: your-service
            port:
              number: 80
```

Pour tester, ajoutez `yourapp.local` à votre fichier `hosts`.
```
